#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"
set -e

echo "ðŸ”§ Pre-commit via DDEV"

# Frontend: lint-staged (eslint + prettier) na STAGED fajlovima
if [ -d "frontendApp" ]; then
  echo "â†’ Frontend lint-staged"
  ddev exec bash -lc 'cd frontendApp && pnpm exec lint-staged'
fi

# Backend: Pint (samo na dirty fajlovima)
if [ -d "backend" ]; then
  echo "â†’ Backend pint --dirty"
  ddev exec bash -lc 'cd backend && ( [ -f vendor/bin/pint ] && vendor/bin/pint --dirty || ./vendor/bin/pint --dirty )'
fi

echo "âœ… Pre-commit OK"
